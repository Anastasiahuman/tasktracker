# Настройка Email (Resend)

## Шаг 1: Регистрация в Resend

1. Перейдите на [resend.com](https://resend.com)
2. Зарегистрируйтесь (бесплатный план включает 3000 писем/месяц)
3. Перейдите в Settings → API Keys
4. Создайте новый API ключ
5. Скопируйте ключ (он начинается с `re_`)

## Шаг 2: Настройка домена (для production)

Для отправки писем в production нужно верифицировать домен:

1. В Resend перейдите в Domains
2. Добавьте ваш домен (например, `yourdomain.com`)
3. Добавьте DNS записи, которые покажет Resend:
   - TXT запись для верификации
   - SPF запись
   - DKIM записи
4. Дождитесь верификации (обычно несколько минут)

## Шаг 3: Настройка для разработки

Для разработки можно использовать тестовый email или домен:

### Вариант 1: Тестовый email (только для разработки)

Resend позволяет отправлять на ваш верифицированный email без настройки домена.

### Вариант 2: Использовать домен Resend (только для разработки)

Можно использовать `onboarding@resend.dev` как отправитель (только для тестирования).

## Шаг 4: Установка переменных окружения

### Локально (apps/api/.env):

```env
RESEND_API_KEY=re_xxxxxxxxxxxxx
FRONTEND_URL=http://localhost:3000
```

### Production:

```env
RESEND_API_KEY=re_xxxxxxxxxxxxx
FRONTEND_URL=https://your-app.vercel.app
```

## Шаг 5: Обновление Email Service

В `apps/api/src/email/email.service.ts` обновите адрес отправителя:

```typescript
from: 'Task Tracker <noreply@yourdomain.com>', // Замените на ваш домен
```

Для разработки можно использовать:
```typescript
from: 'Task Tracker <onboarding@resend.dev>', // Только для тестирования
```

## Проверка работы

1. Запустите API
2. Создайте workspace
3. Пригласите участника через UI
4. Проверьте email (включая спам)

## Troubleshooting

### Письма не приходят

1. Проверьте `RESEND_API_KEY` в переменных окружения
2. Проверьте логи API на ошибки
3. Убедитесь, что домен верифицирован (для production)
4. Проверьте папку "Спам"

### Ошибка "Invalid API key"

- Убедитесь, что ключ скопирован полностью
- Проверьте, что ключ активен в Resend dashboard

### Ошибка "Domain not verified"

- Для production обязательно нужен верифицированный домен
- Для разработки используйте `onboarding@resend.dev`

## Альтернативы Resend

Если хотите использовать другой email сервис:

- **SendGrid** - популярный, бесплатный план 100 писем/день
- **Mailgun** - 5000 писем/месяц бесплатно
- **AWS SES** - очень дешево, но сложнее настройка

Для смены сервиса нужно обновить `apps/api/src/email/email.service.ts`.


